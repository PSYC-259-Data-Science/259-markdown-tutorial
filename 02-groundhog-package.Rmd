---
title: "Reproducing your package environment"
author: "John Franchak"
date: "2/19/2021"
output: html_document
---

This tutorial is about how to use the groundhog package, but we will also look at some more R Markdown features along the way. A good practice is to include a "setup" chunk. This is a good place to load data and packages. You can also set options for the default behavior of a chunk. Setting `echo = T` means that my code will print by default in each chunk. Also note that we can name the chunks to help us organize our document. `include = FALSE` means that we won't see any output from this chunk, but the code will execute.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(groundhog)
```

## Groundhog package

When packages get updated over time, this can change their behavior and change your results. To make your code more reproducible, you can use `groundhog` to load packages based on their version at a specific date.

Install the package by running:
```{r eval = FALSE}
install.packages("groundhog")
library("groundhog")
#Note, the first time you load the package you need to give it permission to save files
```

If we wanted to load a single package on a single date, instead of running:
```{r eval = FALSE}
library("plyr")
```
we would instead run:
```{r eval = TRUE}
groundhog.library("plyr", "2020-01-01")
```

Let's try rerunning this with an earlier date. 

## Other considerations

That's the basics of it, but it's unfortunately not always so simple. Packages often have lots of dependencies (e.g., other packages that they need to work). Groundhog will try to load the correct versions of all of those packages, but it can take a while to track them down/install then. 

Packages also need to run in the correct version of R. Right now, the most updated version of R is 4.0.4 (Lost Library Book). Older packages versions might need to run in R 3.6.3 (Holding the Windsock) from 2020-02-29. You can check you R version like so:
```{r}
my_version <- R.Version()
my_version$version.string
my_version$nickname
```

There is a software tool called "Many Rs" <http://groundhogr.com/many> that can let you switch R versions on the fly. RStudio cloud can also do this, too! Keeping your R version stored with your analyses and the date you ran them will make it easier for you to go back in time to reproduce old code. 

A useful piece of metadata to store in your project could be something like this:
```{r}
Sys.time()
sessionInfo()
```

